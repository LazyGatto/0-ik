[bed_screws]
screw1: 60,115
screw1_name: front screw
screw2: 115,5
screw2_name: back left
screw3: 5,5
screw3_name: back right
probe_height: 0.1

[gcode_macro LOAD_FILAMENT]
gcode:
    SET_PIN PIN=HE-LED VALUE=1
    SET_PIN PIN=daylight VALUE=1
    {% if "xyz" in printer.toolhead.homed_axes %}
        {% set vars = printer['gcode_macro GLOBAL_VARS']|default({}) %}
        {% set max_x = vars.get('variable_bed_x', printer.toolhead.axis_maximum.x)|float %}
        {% set min_x = printer.toolhead.axis_minimum.x|float %}
        {% set min_y = printer.toolhead.axis_minimum.y|float %}
        {% set mid_x = (min_x + max_x) / 2.0 %}
        {% set front_y = min_y + 5.0 %}
        {% set lift_z = vars.get('variable_pause_lift_z', 10.0)|float %}
        G90
        {% if printer.toolhead.position.z < lift_z %}
            G0 Z{lift_z} F3000
        {% endif %}
        G0 X{mid_x} Y{front_y} F12000
    {% endif %}
    {% set did_heat = printer.extruder.temperature < 235 %}
    {% if did_heat %}
        SET_HEATER_TEMPERATURE HEATER=extruder TARGET=240
        TEMPERATURE_WAIT SENSOR=extruder MINIMUM=238
    {% endif %}
    M83
    G1 E30 F300
    G1 E15 F150
    M82
    {% if did_heat %}
        SET_HEATER_TEMPERATURE HEATER=extruder TARGET=0
    {% endif %}

[gcode_macro UNLOAD_FILAMENT]
gcode:
    SET_PIN PIN=HE-LED VALUE=1
    SET_PIN PIN=daylight VALUE=1
    {% if "xyz" in printer.toolhead.homed_axes %}
        {% set vars = printer['gcode_macro GLOBAL_VARS']|default({}) %}
        {% set max_x = vars.get('variable_bed_x', printer.toolhead.axis_maximum.x)|float %}
        {% set min_x = printer.toolhead.axis_minimum.x|float %}
        {% set min_y = printer.toolhead.axis_minimum.y|float %}
        {% set mid_x = (min_x + max_x) / 2.0 %}
        {% set front_y = min_y + 5.0 %}
        {% set lift_z = vars.get('variable_pause_lift_z', 10.0)|float %}
        G90
        {% if printer.toolhead.position.z < lift_z %}
            G0 Z{lift_z} F3000
        {% endif %}
        G0 X{mid_x} Y{front_y} F12000
    {% endif %}
    {% set did_heat = printer.extruder.temperature < 235 %}
    {% if did_heat %}
        SET_HEATER_TEMPERATURE HEATER=extruder TARGET=240
        TEMPERATURE_WAIT SENSOR=extruder MINIMUM=238
    {% endif %}
    M83
    G1 E10 F300
    G1 E-40 F1800
    M82
    {% if did_heat %}
        SET_HEATER_TEMPERATURE HEATER=extruder TARGET=0
    {% endif %}

[gcode_macro POS_F]
gcode:
    {% if "xyz" in printer.toolhead.homed_axes %}
        G90
        {% if printer.toolhead.position.z|float <= 0.001 %}
            G0 Z2.0 F3000
        {% endif %}
        G0 X60 Y115 F12000
        G0 Z0 F3000
    {% else %}
        RESPOND TYPE=error MSG="POS_F: axes not homed"
    {% endif %}

[gcode_macro POS_BR]
gcode:
    {% if "xyz" in printer.toolhead.homed_axes %}
        G90
        {% if printer.toolhead.position.z|float <= 0.001 %}
            G0 Z2.0 F3000
        {% endif %}
        G0 X5 Y5 F12000
        G0 Z0 F3000
    {% else %}
        RESPOND TYPE=error MSG="POS_BR: axes not homed"
    {% endif %}

[gcode_macro POS_BL]
gcode:
    {% if "xyz" in printer.toolhead.homed_axes %}
        G90
        {% if printer.toolhead.position.z|float <= 0.001 %}
            G0 Z2.0 F3000
        {% endif %}
        G0 X115 Y5 F12000
        G0 Z0 F3000
    {% else %}
        RESPOND TYPE=error MSG="POS_BL: axes not homed"
    {% endif %}
